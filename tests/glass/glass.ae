(use 'std/glass.ae')

(let quad-width 60.0)
(let quad-height 30.0)
(let circle-radius 40.0)

(let init [] ->
  {
    'atom': (glass/load-texture 'tests/glass/atom-icon.jpg')
    'krypton': (glass/load-font 'tests/glass/MonaspaceKrypton-Regular-static.otf')
    'text': 'Wow!,'
  }
)

(let event-hanlder [state event] ->
  (if (or (== event::'type' 'key-press')
          (== event::'type' 'key-hold'))
    (println event::'key-code' ':' event::'char'))
  state)

(let update [state] -> state)

(let render [state] ->
  (glass/clear 0.0 0.0 0.0 1.0)

  (let size (glass/window-size))

  (glass/textured-quad 0.0 0.0 200.0 200.0 state::'atom')

  (glass/circle (/ size::'width' 2.0)
                (/ size::'height' 2.0)
                circle-radius 1.0 1.0 1.0 1.0)

  (glass/quad (/ (- size::'width' quad-width) 2.0)
              (/ (- size::'height' quad-height) 2.0)
              quad-width quad-height 0.7 0.2 0.4 1.0)

  (let text-width (glass/text-width 48 state::'krypton' state::'text'))
  (glass/text (/ (- size::'width' text-width) 2.0)
              (- size::'height' 100.0)
              48 state::'krypton'
              state::'text'))

(glass/run 'Hello, OpenGL!' 640 480 init event-hanlder update render)

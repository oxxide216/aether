(use '../std/lib.ae')

(let todos [])

(fun add-todo [todo]
  (set todos (add todos todo)))

(fun remove-todo [todo-to-remove]
  (set todos (filter (fun [todo] (ne todo todo-to-remove)) todos)))

(fun print-todos [left]
  (if (not (is-empty left))
    (println (head left))
    (print-todos (tail left))))

(while true
  (print '>> ')

  (let command (split (input) ' '))

  (if (and (eq (head command) 'add') (not (is-empty (tail command))))
    (add-todo (head (tail command)))
   elif (and (eq (head command) 'remove') (not (is-empty (tail command))))
    (remove-todo (head (tail command)))
   elif (eq (head command) 'list')
    (print-todos todos)
   else
    (print 'ERROR: `')
    (print (head command))
    (println '`: unknown command')))
